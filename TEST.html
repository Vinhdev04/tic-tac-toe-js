<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Tic Tac Toe - Ultimate</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      .container {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(20px);
        border-radius: 25px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 40px;
        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
        text-align: center;
        max-width: 500px;
        width: 100%;
        transition: transform 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .container:hover {
        transform: translateY(-5px);
      }

      h1 {
        color: #fff;
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 30px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        background: linear-gradient(45deg, #fff, #e0e7ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: glow 2s ease-in-out infinite alternate;
      }

      @keyframes glow {
        from {
          filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3));
        }
        to {
          filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.6));
        }
      }

      .game-info {
        margin-bottom: 20px;
      }

      .current-player {
        color: #fff;
        font-size: 1.2rem;
        font-weight: 600;
        background: rgba(255, 255, 255, 0.1);
        padding: 10px 20px;
        border-radius: 20px;
        display: inline-block;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
      }

      .player-x {
        color: #ff6b6b;
        text-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
      }
      .player-o {
        color: #4ecdc4;
        text-shadow: 0 0 10px rgba(78, 205, 196, 0.5);
      }

      .game-board {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin: 30px 0;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 20px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        min-height: 250px;
      }

      .cell {
        aspect-ratio: 1;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        font-size: 2.5rem;
        font-weight: bold;
        color: #fff;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }

      .cell:hover:not(.taken) {
        background: rgba(255, 255, 255, 0.2);
        transform: scale(1.05);
        border-color: rgba(255, 255, 255, 0.4);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      }

      .cell.taken {
        cursor: not-allowed;
      }

      .cell.x {
        color: #ff6b6b;
        background: linear-gradient(
          135deg,
          rgba(255, 107, 107, 0.2),
          rgba(255, 107, 107, 0.1)
        );
        border-color: #ff6b6b;
        animation: cellAppear 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }

      .cell.o {
        color: #4ecdc4;
        background: linear-gradient(
          135deg,
          rgba(78, 205, 196, 0.2),
          rgba(78, 205, 196, 0.1)
        );
        border-color: #4ecdc4;
        animation: cellAppear 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      }

      .cell.winning {
        animation: winning 1s ease-in-out infinite;
        background: linear-gradient(135deg, #ffd700, #ffed4e);
        color: #333;
        border-color: #ffd700;
        box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
      }

      @keyframes cellAppear {
        0% {
          transform: scale(0) rotate(180deg);
          opacity: 0;
        }
        50% {
          transform: scale(1.2) rotate(90deg);
          opacity: 0.8;
        }
        100% {
          transform: scale(1) rotate(0deg);
          opacity: 1;
        }
      }

      @keyframes winning {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
        }
        50% {
          transform: scale(1.1);
          box-shadow: 0 0 50px rgba(255, 215, 0, 0.8);
        }
      }

      .controls {
        display: flex;
        flex-direction: column;
        gap: 15px;
        margin-top: 20px;
      }

      .btn {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 25px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
      }

      .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        background: linear-gradient(135deg, #764ba2, #667eea);
      }

      .btn:active {
        transform: translateY(-1px);
      }

      .btn.secondary {
        background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      }

      .btn.secondary:hover {
        background: linear-gradient(135deg, #ee5a24, #ff6b6b);
      }

      .game-status {
        margin: 20px 0;
        font-size: 1.3rem;
        font-weight: 600;
        color: #fff;
        min-height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 15px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .winner-animation {
        animation: celebration 1.5s ease-in-out;
        background: linear-gradient(
          135deg,
          rgba(255, 215, 0, 0.3),
          rgba(255, 255, 255, 0.1)
        );
        border-color: #ffd700;
      }

      @keyframes celebration {
        0%,
        20%,
        40%,
        60%,
        80%,
        100% {
          transform: translateY(0) scale(1);
        }
        10%,
        30%,
        50%,
        70%,
        90% {
          transform: translateY(-10px) scale(1.05);
        }
      }

      .score-board {
        margin-top: 25px;
        background: rgba(255, 255, 255, 0.1);
        padding: 20px;
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .score-title {
        color: #fff;
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 15px;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
      }

      .score-item {
        color: #fff;
        font-size: 1.1rem;
        margin: 8px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 5px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .score-item:last-child {
        border-bottom: none;
      }

      .score-value {
        font-weight: bold;
        padding: 5px 10px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        min-width: 30px;
        text-align: center;
      }

      /* Responsive Design */
      @media (max-width: 600px) {
        .container {
          padding: 20px;
          margin: 10px;
        }

        h1 {
          font-size: 2rem;
          margin-bottom: 20px;
        }

        .cell {
          font-size: 2rem;
        }

        .game-board {
          gap: 10px;
          padding: 15px;
          min-height: 200px;
        }

        .btn {
          padding: 12px 20px;
          font-size: 1rem;
        }

        .current-player {
          font-size: 1rem;
          padding: 8px 16px;
        }
      }

      @media (max-width: 400px) {
        h1 {
          font-size: 1.5rem;
        }

        .cell {
          font-size: 1.5rem;
        }

        .container {
          padding: 15px;
        }
      }

      /* Animations for page load */
      .container {
        animation: slideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(30px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      /* Particle effect background */
      .container::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.05) 1px,
          transparent 1px
        );
        background-size: 50px 50px;
        animation: float 20s linear infinite;
        pointer-events: none;
        z-index: -1;
      }

      @keyframes float {
        0% {
          transform: translate(0, 0) rotate(0deg);
        }
        100% {
          transform: translate(-50px, -50px) rotate(360deg);
        }
      }

      /* Game mode selector */
      .game-modes {
        margin-bottom: 20px;
        display: flex;
        justify-content: center;
        gap: 10px;
      }

      .mode-btn {
        padding: 8px 16px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        background: rgba(255, 255, 255, 0.1);
        color: white;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.9rem;
      }

      .mode-btn.active {
        background: rgba(255, 255, 255, 0.2);
        border-color: rgba(255, 255, 255, 0.5);
      }

      .mode-btn:hover {
        background: rgba(255, 255, 255, 0.15);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Tic Tac Toe</h1>

      <div class="game-modes">
        <button class="mode-btn active" data-mode="human">
          👥 Human vs Human
        </button>
        <button class="mode-btn" data-mode="ai">🤖 vs Computer</button>
      </div>

      <div class="game-info">
        <div class="current-player" id="currentPlayer">
          Current Player: <span class="player-x">X</span>
        </div>
      </div>

      <div class="game-status" id="gameStatus">Make your move!</div>

      <div class="game-board" id="gameBoard">
        <button class="cell" data-index="0"></button>
        <button class="cell" data-index="1"></button>
        <button class="cell" data-index="2"></button>
        <button class="cell" data-index="3"></button>
        <button class="cell" data-index="4"></button>
        <button class="cell" data-index="5"></button>
        <button class="cell" data-index="6"></button>
        <button class="cell" data-index="7"></button>
        <button class="cell" data-index="8"></button>
      </div>

      <div class="controls">
        <button class="btn" id="resetBtn">🎮 New Game</button>
        <button class="btn secondary" id="clearScoreBtn">🏆 Clear Score</button>
      </div>

      <div class="score-board">
        <div class="score-title">🏆 Score Board</div>
        <div class="score-item">
          <span>Player X:</span>
          <span class="score-value" id="scoreX">0</span>
        </div>
        <div class="score-item">
          <span>Player O:</span>
          <span class="score-value" id="scoreO">0</span>
        </div>
        <div class="score-item">
          <span>Draws:</span>
          <span class="score-value" id="scoreDraw">0</span>
        </div>
      </div>
    </div>

    <script>
      class TicTacToe {
        constructor() {
          this.board = Array(9).fill("");
          this.currentPlayer = "X";
          this.gameActive = true;
          this.gameMode = "human"; // 'human' or 'ai'
          this.scores = { X: 0, O: 0, draw: 0 };
          this.winningCombination = null;

          // DOM elements
          this.cells = document.querySelectorAll(".cell");
          this.gameStatus = document.getElementById("gameStatus");
          this.currentPlayerDisplay = document.getElementById("currentPlayer");
          this.resetBtn = document.getElementById("resetBtn");
          this.clearScoreBtn = document.getElementById("clearScoreBtn");
          this.modeBtns = document.querySelectorAll(".mode-btn");

          this.initializeGame();
          this.loadScores();
        }

        initializeGame() {
          // Cell click handlers
          this.cells.forEach((cell, index) => {
            cell.addEventListener("click", () => this.handleCellClick(index));
          });

          // Button handlers
          this.resetBtn.addEventListener("click", () => this.resetGame());
          this.clearScoreBtn.addEventListener("click", () =>
            this.clearScores()
          );

          // Game mode handlers
          this.modeBtns.forEach((btn) => {
            btn.addEventListener("click", () =>
              this.setGameMode(btn.dataset.mode)
            );
          });

          this.updateDisplay();
        }

        setGameMode(mode) {
          this.gameMode = mode;
          this.modeBtns.forEach((btn) => {
            btn.classList.toggle("active", btn.dataset.mode === mode);
          });
          this.resetGame();
        }

        handleCellClick(index) {
          // Check if move is valid
          if (this.board[index] !== "" || !this.gameActive) return;

          // Human player makes move
          this.makeMove(index, this.currentPlayer);

          // Check game state after human move
          if (this.checkGameEnd()) return;

          // AI move if in AI mode and it's O's turn
          if (this.gameMode === "ai" && this.currentPlayer === "O") {
            setTimeout(() => {
              if (this.gameActive) {
                this.makeAIMove();
              }
            }, 500); // Small delay for better UX
          }
        }

        makeMove(index, player) {
          this.board[index] = player;
          const cell = this.cells[index];

          // Update cell appearance
          cell.textContent = player;
          cell.classList.add(player.toLowerCase(), "taken");

          // Check for game end conditions
          if (this.checkWinner()) {
            this.endGame(`Player ${player} wins! 🎉`);
            this.scores[player]++;
            this.highlightWinningCells();
          } else if (this.board.every((cell) => cell !== "")) {
            this.endGame("It's a draw! 🤝");
            this.scores.draw++;
          } else {
            // Switch players
            this.currentPlayer = this.currentPlayer === "X" ? "O" : "X";
            this.updateDisplay();
          }

          this.saveScores();
          this.updateScoreDisplay();
        }

        makeAIMove() {
          const bestMove = this.getBestMove();
          if (bestMove !== -1) {
            this.makeMove(bestMove, "O");
          }
        }

        getBestMove() {
          // First, try to win
          for (let i = 0; i < 9; i++) {
            if (this.board[i] === "") {
              this.board[i] = "O";
              if (this.checkWinner()) {
                this.board[i] = ""; // Reset
                return i;
              }
              this.board[i] = ""; // Reset
            }
          }

          // Second, block player from winning
          for (let i = 0; i < 9; i++) {
            if (this.board[i] === "") {
              this.board[i] = "X";
              if (this.checkWinner()) {
                this.board[i] = ""; // Reset
                return i;
              }
              this.board[i] = ""; // Reset
            }
          }

          // Third, take center if available
          if (this.board[4] === "") {
            return 4;
          }

          // Fourth, take corners
          const corners = [0, 2, 6, 8];
          const availableCorners = corners.filter((i) => this.board[i] === "");
          if (availableCorners.length > 0) {
            return availableCorners[
              Math.floor(Math.random() * availableCorners.length)
            ];
          }

          // Finally, take any available space
          const availableMoves = [];
          for (let i = 0; i < 9; i++) {
            if (this.board[i] === "") {
              availableMoves.push(i);
            }
          }

          return availableMoves.length > 0
            ? availableMoves[Math.floor(Math.random() * availableMoves.length)]
            : -1;
        }

        checkWinner() {
          const winningCombinations = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8], // rows
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8], // columns
            [0, 4, 8],
            [2, 4, 6], // diagonals
          ];

          for (let combination of winningCombinations) {
            const [a, b, c] = combination;
            if (
              this.board[a] &&
              this.board[a] === this.board[b] &&
              this.board[a] === this.board[c]
            ) {
              this.winningCombination = combination;
              return true;
            }
          }
          return false;
        }

        checkGameEnd() {
          return !this.gameActive;
        }

        highlightWinningCells() {
          if (this.winningCombination) {
            this.winningCombination.forEach((index) => {
              this.cells[index].classList.add("winning");
            });
          }
        }

        endGame(message) {
          this.gameActive = false;
          this.gameStatus.textContent = message;
          this.gameStatus.classList.add("winner-animation");

          // Add confetti effect for wins
          if (message.includes("wins")) {
            this.createConfetti();
          }

          setTimeout(() => {
            this.gameStatus.classList.remove("winner-animation");
          }, 1500);
        }

        createConfetti() {
          // Simple confetti effect
          for (let i = 0; i < 50; i++) {
            setTimeout(() => {
              const confetti = document.createElement("div");
              confetti.style.cssText = `
                            position: fixed;
                            width: 10px;
                            height: 10px;
                            background: ${
                              ["#ff6b6b", "#4ecdc4", "#ffd700", "#667eea"][
                                Math.floor(Math.random() * 4)
                              ]
                            };
                            left: ${Math.random() * 100}vw;
                            top: -10px;
                            border-radius: 50%;
                            pointer-events: none;
                            animation: confetti-fall 3s linear forwards;
                            z-index: 1000;
                        `;

              document.body.appendChild(confetti);

              setTimeout(() => {
                confetti.remove();
              }, 3000);
            }, i * 50);
          }

          // Add confetti animation
          if (!document.getElementById("confetti-style")) {
            const style = document.createElement("style");
            style.id = "confetti-style";
            style.textContent = `
                        @keyframes confetti-fall {
                            to {
                                transform: translateY(100vh) rotate(360deg);
                            }
                        }
                    `;
            document.head.appendChild(style);
          }
        }

        resetGame() {
          this.board = Array(9).fill("");
          this.currentPlayer = "X";
          this.gameActive = true;
          this.winningCombination = null;

          // Reset all cells
          this.cells.forEach((cell) => {
            cell.textContent = "";
            cell.className = "cell";
          });

          this.gameStatus.textContent = "Make your move!";
          this.gameStatus.classList.remove("winner-animation");
          this.updateDisplay();
        }

        updateDisplay() {
          const playerSpan = this.currentPlayerDisplay.querySelector("span");
          playerSpan.textContent = this.currentPlayer;
          playerSpan.className =
            this.currentPlayer === "X" ? "player-x" : "player-o";

          // Update status message for AI mode
          if (
            this.gameMode === "ai" &&
            this.currentPlayer === "O" &&
            this.gameActive
          ) {
            this.gameStatus.textContent = "Computer is thinking...";
          } else if (this.gameActive) {
            this.gameStatus.textContent = "Make your move!";
          }
        }

        updateScoreDisplay() {
          document.getElementById("scoreX").textContent = this.scores.X;
          document.getElementById("scoreO").textContent = this.scores.O;
          document.getElementById("scoreDraw").textContent = this.scores.draw;
        }

        saveScores() {
          try {
            window.gameScores = JSON.stringify(this.scores);
          } catch (e) {
            console.warn("Could not save scores:", e);
          }
        }

        loadScores() {
          try {
            const savedScores = window.gameScores;
            if (savedScores) {
              this.scores = JSON.parse(savedScores);
            }
          } catch (e) {
            console.warn("Could not load scores:", e);
            this.scores = { X: 0, O: 0, draw: 0 };
          }
          this.updateScoreDisplay();
        }

        clearScores() {
          this.scores = { X: 0, O: 0, draw: 0 };
          this.updateScoreDisplay();
          this.saveScores();

          // Add a fun animation to score board
          const scoreBoard = document.querySelector(".score-board");
          scoreBoard.style.transform = "scale(1.05)";
          scoreBoard.style.background = "rgba(255, 255, 255, 0.2)";

          setTimeout(() => {
            scoreBoard.style.transform = "scale(1)";
            scoreBoard.style.background = "rgba(255, 255, 255, 0.1)";
          }, 300);
        }
      }

      // Initialize the game when the page loads
      document.addEventListener("DOMContentLoaded", () => {
        new TicTacToe();
      });

      // Enhanced interactive background effects
      document.addEventListener("mousemove", (e) => {
        const container = document.querySelector(".container");
        const rect = container.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        const centerX = rect.width / 2;
        const centerY = rect.height / 2;

        const rotateX = (y - centerY) / 30;
        const rotateY = (centerX - x) / 30;

        container.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateY(-5px)`;
      });

      // Reset transform when mouse leaves
      document.addEventListener("mouseleave", () => {
        const container = document.querySelector(".container");
        container.style.transform =
          "perspective(1000px) rotateX(0deg) rotateY(0deg) translateY(0px)";
      });

      // Add keyboard support
      document.addEventListener("keydown", (e) => {
        if (e.key >= "1" && e.key <= "9") {
          const index = parseInt(e.key) - 1;
          const cell = document.querySelector(`[data-index="${index}"]`);
          if (cell && !cell.classList.contains("taken")) {
            cell.click();
          }
        } else if (e.key === "r" || e.key === "R") {
          document.getElementById("resetBtn").click();
        }
      });
    </script>
  </body>
</html>
